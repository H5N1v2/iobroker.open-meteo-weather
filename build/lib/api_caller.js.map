{
  "version": 3,
  "sources": ["../../src/lib/api_caller.ts"],
  "sourcesContent": ["// api_caller.ts\nimport axios from 'axios';\n\n/**\n * Konfiguration f\u00FCr den Wetter-API-Abruf\n */\nexport interface WeatherConfig {\n\t/** Breitengrad */\n\tlatitude: number;\n\t/** L\u00E4ngengrad */\n\tlongitude: number;\n\t/** Anzahl der Vorhersagetage */\n\tforecastDays: number;\n\t/** Anzahl der Vorhersagestunden */\n\tforecastHours: number;\n\t/** Ob st\u00FCndliche Vorhersage aktiviert ist */\n\tforecastHoursEnabled: boolean;\n\t/** Ob Luftqualit\u00E4tsdaten abgerufen werden sollen */\n\tairQualityEnabled: boolean;\n\t/** Die Zeitzone (z.B. Europe/Berlin) */\n\ttimezone: string;\n\t/** Ob imperiale Einheiten genutzt werden sollen */\n\tisImperial: boolean;\n}\n\n/**\n * Holt alle Wetter- und Luftqualit\u00E4tsdaten von der Open-Meteo API\n *\n * @param config Die Konfiguration f\u00FCr den Abruf\n * @param logger Optionaler ioBroker Logger f\u00FCr Debug-Ausgaben\n * @returns Die abgerufenen Wetterdaten als Objekt\n */\nexport async function fetchAllWeatherData(config: WeatherConfig, logger?: ioBroker.Logger): Promise<any> {\n\tconst tz = encodeURIComponent(config.timezone);\n\tconst results: any = {};\n\n\t// Imperiale Parameter vorbereiten\n\tconst unitParams = config.isImperial\n\t\t? '&temperature_unit=fahrenheit&wind_speed_unit=mph&precipitation_unit=inch'\n\t\t: '';\n\n\tlet fHoursParam = '';\n\tlet fHoursParam_keys = '';\n\n\tif (config.forecastHoursEnabled) {\n\t\tconst totalHours = config.forecastDays * 24;\n\t\tfHoursParam = `&forecast_hours=${totalHours}`;\n\t\tfHoursParam_keys = `&hourly=temperature_2m,relative_humidity_2m,dew_point_2m,precipitation_probability,rain,weather_code,pressure_msl,cloud_cover,wind_speed_10m,wind_direction_10m,wind_gusts_10m,soil_temperature_0cm,uv_index,sunshine_duration,is_day,snowfall,snow_depth`;\n\t}\n\tconst currentparam_keys =\n\t\t'temperature_2m,relative_humidity_2m,pressure_msl,apparent_temperature,precipitation,weather_code,cloud_cover,wind_speed_10m,wind_direction_10m,wind_gusts_10m,is_day';\n\n\tconst dailyparam_keys =\n\t\t'relative_humidity_2m_mean,weather_code,temperature_2m_max,temperature_2m_min,pressure_msl_mean,sunrise,sunshine_duration,sunset,uv_index_max,rain_sum,snowfall_sum,precipitation_probability_max,wind_speed_10m_max,wind_direction_10m_dominant,wind_gusts_10m_max,dew_point_2m_mean';\n\n\t// URL mit unitParams erweitern\n\tconst weatherUrl = `https://api.open-meteo.com/v1/forecast?latitude=${config.latitude}&longitude=${config.longitude}&current=${currentparam_keys}&daily=${dailyparam_keys}${fHoursParam_keys}&timezone=${tz}&forecast_days=${config.forecastDays}${fHoursParam}${unitParams}`;\n\n\tif (logger) {\n\t\tlogger.debug(`Open-Meteo Weather URL: ${weatherUrl}`);\n\t}\n\n\tconst resW = await axios.get(weatherUrl);\n\n\tif (logger) {\n\t\tlogger.debug(`Open-Meteo Weather Response Status: ${resW.status}`);\n\t}\n\n\tresults.weather = resW.data;\n\n\tif (resW.data.hourly) {\n\t\tresults.hourly = resW.data;\n\t}\n\n\tconst pollenparam_keys =\n\t\t'pm10,pm2_5,alder_pollen,birch_pollen,grass_pollen,mugwort_pollen,ragweed_pollen,carbon_monoxide,dust,olive_pollen,ozone';\n\tif (config.airQualityEnabled) {\n\t\tconst airUrl = `https://air-quality-api.open-meteo.com/v1/air-quality?latitude=${config.latitude}&longitude=${config.longitude}&current=european_aqi,${pollenparam_keys}&timezone=${tz}&forecast_days=${config.forecastDays > 7 ? 7 : config.forecastDays}`;\n\n\t\tif (logger) {\n\t\t\tlogger.debug(`Open-Meteo Air Quality URL: ${airUrl}`);\n\t\t}\n\n\t\tconst resA = await axios.get(airUrl);\n\n\t\tif (logger) {\n\t\t\tlogger.debug(`Open-Meteo Air Quality Response Status: ${resA.status}`);\n\t\t}\n\n\t\tresults.air = resA.data;\n\t}\n\n\treturn results;\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AACA,mBAAkB;AA+BlB,eAAsB,oBAAoB,QAAuB,QAAwC;AACxG,QAAM,KAAK,mBAAmB,OAAO,QAAQ;AAC7C,QAAM,UAAe,CAAC;AAGtB,QAAM,aAAa,OAAO,aACvB,6EACA;AAEH,MAAI,cAAc;AAClB,MAAI,mBAAmB;AAEvB,MAAI,OAAO,sBAAsB;AAChC,UAAM,aAAa,OAAO,eAAe;AACzC,kBAAc,mBAAmB,UAAU;AAC3C,uBAAmB;AAAA,EACpB;AACA,QAAM,oBACL;AAED,QAAM,kBACL;AAGD,QAAM,aAAa,mDAAmD,OAAO,QAAQ,cAAc,OAAO,SAAS,YAAY,iBAAiB,UAAU,eAAe,GAAG,gBAAgB,aAAa,EAAE,kBAAkB,OAAO,YAAY,GAAG,WAAW,GAAG,UAAU;AAE3Q,MAAI,QAAQ;AACX,WAAO,MAAM,2BAA2B,UAAU,EAAE;AAAA,EACrD;AAEA,QAAM,OAAO,MAAM,aAAAA,QAAM,IAAI,UAAU;AAEvC,MAAI,QAAQ;AACX,WAAO,MAAM,uCAAuC,KAAK,MAAM,EAAE;AAAA,EAClE;AAEA,UAAQ,UAAU,KAAK;AAEvB,MAAI,KAAK,KAAK,QAAQ;AACrB,YAAQ,SAAS,KAAK;AAAA,EACvB;AAEA,QAAM,mBACL;AACD,MAAI,OAAO,mBAAmB;AAC7B,UAAM,SAAS,kEAAkE,OAAO,QAAQ,cAAc,OAAO,SAAS,yBAAyB,gBAAgB,aAAa,EAAE,kBAAkB,OAAO,eAAe,IAAI,IAAI,OAAO,YAAY;AAEzP,QAAI,QAAQ;AACX,aAAO,MAAM,+BAA+B,MAAM,EAAE;AAAA,IACrD;AAEA,UAAM,OAAO,MAAM,aAAAA,QAAM,IAAI,MAAM;AAEnC,QAAI,QAAQ;AACX,aAAO,MAAM,2CAA2C,KAAK,MAAM,EAAE;AAAA,IACtE;AAEA,YAAQ,MAAM,KAAK;AAAA,EACpB;AAEA,SAAO;AACR;",
  "names": ["axios"]
}
